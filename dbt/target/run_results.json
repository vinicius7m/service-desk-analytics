{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.0", "generated_at": "2025-09-18T02:48:04.230643Z", "invocation_id": "22b72729-df60-4e36-a9ed-439e3cbba696", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-18T02:47:52.713942Z", "completed_at": "2025-09-18T02:47:52.726358Z"}, {"name": "execute", "started_at": "2025-09-18T02:47:52.729351Z", "completed_at": "2025-09-18T02:47:54.506115Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.8135685920715332, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "us-central1", "project_id": "service-desk-analytics-472019", "job_id": "7a466d85-0c17-40e0-9b86-9a768ba55a75", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.service_desk_analytics.stg_chamados", "compiled": true, "compiled_code": "\n\nWITH raw_data AS (\n    SELECT * FROM `service-desk-analytics-472019`.`raw`.`chamados`\n),\n\ncleaned AS (\n    SELECT\n        -- IDs e Datas (valida\u00e7\u00e3o b\u00e1sica)\n        id_chamado,\n        CAST(data_abertura AS TIMESTAMP) AS data_abertura,\n        CAST(data_fechamento AS TIMESTAMP) AS data_fechamento,\n        \n        -- Categorias (padroniza\u00e7\u00e3o)\n        UPPER(TRIM(categoria)) AS categoria,\n        INITCAP(TRIM(canal)) AS canal,\n        \n        -- Prioridade (tratamento de nulos e padroniza\u00e7\u00e3o)\n        CASE \n            WHEN prioridade IS NULL THEN 'N\u00c3O_INFORMADA'\n            ELSE INITCAP(TRIM(prioridade))\n        END AS prioridade,\n        \n        -- Status (valida\u00e7\u00e3o)\n        CASE \n            WHEN status IN ('Aberto', 'Em andamento', 'Fechado') THEN status\n            ELSE 'STATUS_DESCONHECIDO'\n        END AS status,\n        \n        -- M\u00e9tricas num\u00e9ricas (tratamento de outliers)\n        CAST(tempo_espera AS NUMERIC) AS tempo_espera_minutos,\n        CAST(tempo_resolucao AS NUMERIC) AS tempo_resolucao_horas,\n        \n        -- CSAT (valores v\u00e1lidos 1-5, nulos tratados)\n        CASE \n            WHEN csat BETWEEN 1 AND 5 THEN csat\n            ELSE NULL\n        END AS csat_score,\n        \n        -- Flags booleanas (garantir consist\u00eancia)\n        CAST(sla_atingido AS BOOLEAN) AS is_sla_atingido,\n        CAST(first_contact_resolution AS BOOLEAN) AS is_first_contact,\n        \n        -- Metadados para qualidade\n        CURRENT_TIMESTAMP() AS dbt_loaded_at\n\n    FROM raw_data\n)\n\nSELECT * FROM cleaned", "relation_name": "`service-desk-analytics-472019`.`raw_staging`.`stg_chamados`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-18T02:47:52.699652Z", "completed_at": "2025-09-18T02:47:52.727719Z"}, {"name": "execute", "started_at": "2025-09-18T02:47:52.750538Z", "completed_at": "2025-09-18T02:47:56.313567Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.6236705780029297, "adapter_response": {"_message": "CREATE TABLE (2.1k rows, 0 processed)", "code": "CREATE TABLE", "rows_affected": 2088, "bytes_processed": 0, "bytes_billed": 0, "location": "us-central1", "project_id": "service-desk-analytics-472019", "job_id": "eec34093-f770-4f1a-a9bf-55debebbc023", "slot_ms": 1809}, "message": "CREATE TABLE (2.1k rows, 0 processed)", "failures": null, "unique_id": "model.service_desk_analytics.dim_tempo", "compiled": true, "compiled_code": "\n\nWITH dates AS (\n    SELECT *\n    FROM unnest(generate_date_array('2020-01-01', current_date(), interval 1 day)) AS data\n)\n\nSELECT\n    row_number() OVER(ORDER BY data) AS id_tempo,\n    data,\n    EXTRACT(year FROM data) AS ano,\n    EXTRACT(quarter FROM data) AS trimestre,\n    EXTRACT(month FROM data) AS mes,\n    format_date('%Y-%m', data) AS ano_mes,\n    EXTRACT(day FROM data) AS dia,\n    EXTRACT(dayofweek FROM data) AS dia_semana,\n    CASE EXTRACT(dayofweek FROM data)\n        WHEN 1 THEN 'Domingo'\n        WHEN 2 THEN 'Segunda'\n        WHEN 3 THEN 'Ter\u00e7a'\n        WHEN 4 THEN 'Quarta'\n        WHEN 5 THEN 'Quinta'\n        WHEN 6 THEN 'Sexta'\n        WHEN 7 THEN 'S\u00e1bado'\n    END AS nome_dia_semana\nFROM dates", "relation_name": "`service-desk-analytics-472019`.`raw_marts`.`dim_tempo`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-18T02:47:54.523604Z", "completed_at": "2025-09-18T02:47:54.537844Z"}, {"name": "execute", "started_at": "2025-09-18T02:47:54.539374Z", "completed_at": "2025-09-18T02:47:56.320652Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.8016242980957031, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "us-central1", "project_id": "service-desk-analytics-472019", "job_id": "3fc7e62e-8124-48a0-8d79-a59facb463b9", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.service_desk_analytics.int_chamados", "compiled": true, "compiled_code": "\n\nSELECT\n    stg.id_chamado,\n    stg.data_abertura,\n    stg.data_fechamento,\n    date(stg.data_abertura) AS dt_abertura,\n    date(stg.data_fechamento) AS dt_fechamento,\n    stg.categoria,\n    stg.canal,\n    stg.prioridade,\n    stg.status,\n    stg.tempo_espera_minutos,\n    stg.tempo_resolucao_horas,\n    stg.csat_score,\n    stg.is_sla_atingido,\n    stg.is_first_contact\nFROM `service-desk-analytics-472019`.`raw_staging`.`stg_chamados` stg", "relation_name": "`service-desk-analytics-472019`.`raw_intermediate`.`int_chamados`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-18T02:47:56.382933Z", "completed_at": "2025-09-18T02:47:56.399811Z"}, {"name": "execute", "started_at": "2025-09-18T02:47:56.405696Z", "completed_at": "2025-09-18T02:48:00.244836Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.891923666000366, "adapter_response": {"_message": "CREATE TABLE (5.0 rows, 4.3 KiB processed)", "code": "CREATE TABLE", "rows_affected": 5, "bytes_processed": 4420, "bytes_billed": 10485760, "location": "us-central1", "project_id": "service-desk-analytics-472019", "job_id": "7b68585e-c816-4140-8bf7-07e1b7e70988", "slot_ms": 2075}, "message": "CREATE TABLE (5.0 rows, 4.3 KiB processed)", "failures": null, "unique_id": "model.service_desk_analytics.dim_prioridade", "compiled": true, "compiled_code": "\n\nSELECT\n    row_number() OVER(ORDER BY prioridade) AS id_prioridade,\n    prioridade\nFROM (\n    SELECT DISTINCT prioridade FROM `service-desk-analytics-472019`.`raw_intermediate`.`int_chamados`\n) t", "relation_name": "`service-desk-analytics-472019`.`raw_marts`.`dim_prioridade`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-18T02:47:56.387902Z", "completed_at": "2025-09-18T02:47:56.400248Z"}, {"name": "execute", "started_at": "2025-09-18T02:47:56.441811Z", "completed_at": "2025-09-18T02:48:00.239888Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.8856074810028076, "adapter_response": {"_message": "CREATE TABLE (3.0 rows, 6.0 KiB processed)", "code": "CREATE TABLE", "rows_affected": 3, "bytes_processed": 6103, "bytes_billed": 10485760, "location": "us-central1", "project_id": "service-desk-analytics-472019", "job_id": "79333f10-4e8f-406c-ab67-1afaaa30cf61", "slot_ms": 2181}, "message": "CREATE TABLE (3.0 rows, 6.0 KiB processed)", "failures": null, "unique_id": "model.service_desk_analytics.dim_status", "compiled": true, "compiled_code": "\n\nSELECT\n    row_number() OVER(ORDER BY status) AS id_status,\n    status\nFROM (\n    SELECT DISTINCT status FROM `service-desk-analytics-472019`.`raw_intermediate`.`int_chamados`\n) t", "relation_name": "`service-desk-analytics-472019`.`raw_marts`.`dim_status`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-18T02:47:56.364577Z", "completed_at": "2025-09-18T02:47:56.394727Z"}, {"name": "execute", "started_at": "2025-09-18T02:47:56.396672Z", "completed_at": "2025-09-18T02:48:00.278330Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.9287540912628174, "adapter_response": {"_message": "CREATE TABLE (4.0 rows, 5.3 KiB processed)", "code": "CREATE TABLE", "rows_affected": 4, "bytes_processed": 5416, "bytes_billed": 10485760, "location": "us-central1", "project_id": "service-desk-analytics-472019", "job_id": "9b9af422-e943-4bf2-b026-23f0a1aaac35", "slot_ms": 2112}, "message": "CREATE TABLE (4.0 rows, 5.3 KiB processed)", "failures": null, "unique_id": "model.service_desk_analytics.dim_canal", "compiled": true, "compiled_code": "\n\nSELECT\n    row_number() OVER(ORDER BY canal) AS id_canal,\n    canal\nFROM (\n    SELECT DISTINCT canal FROM `service-desk-analytics-472019`.`raw_intermediate`.`int_chamados`\n) t", "relation_name": "`service-desk-analytics-472019`.`raw_marts`.`dim_canal`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-18T02:47:56.375621Z", "completed_at": "2025-09-18T02:47:56.395733Z"}, {"name": "execute", "started_at": "2025-09-18T02:47:56.400721Z", "completed_at": "2025-09-18T02:48:00.382062Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 4.030748128890991, "adapter_response": {"_message": "CREATE TABLE (4.0 rows, 6.0 KiB processed)", "code": "CREATE TABLE", "rows_affected": 4, "bytes_processed": 6128, "bytes_billed": 10485760, "location": "us-central1", "project_id": "service-desk-analytics-472019", "job_id": "a091231d-12b0-4a0d-8128-b9be3af5127b", "slot_ms": 2340}, "message": "CREATE TABLE (4.0 rows, 6.0 KiB processed)", "failures": null, "unique_id": "model.service_desk_analytics.dim_categoria", "compiled": true, "compiled_code": "\n\nselect\n    row_number() over(order by categoria) as id_categoria,\n    categoria\nfrom (\n    select distinct categoria from `service-desk-analytics-472019`.`raw_intermediate`.`int_chamados`\n) t", "relation_name": "`service-desk-analytics-472019`.`raw_marts`.`dim_categoria`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-18T02:48:00.402772Z", "completed_at": "2025-09-18T02:48:00.416658Z"}, {"name": "execute", "started_at": "2025-09-18T02:48:00.418393Z", "completed_at": "2025-09-18T02:48:04.144370Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.7471768856048584, "adapter_response": {"_message": "CREATE TABLE (600.0 rows, 106.9 KiB processed)", "code": "CREATE TABLE", "rows_affected": 600, "bytes_processed": 109507, "bytes_billed": 62914560, "location": "us-central1", "project_id": "service-desk-analytics-472019", "job_id": "9c6c223c-db3f-4daa-99a3-10ba8920ddc2", "slot_ms": 1929}, "message": "CREATE TABLE (600.0 rows, 106.9 KiB processed)", "failures": null, "unique_id": "model.service_desk_analytics.fato_chamados", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        int.id_chamado,\n        t_ab.id_tempo as id_tempo_abertura,\n        t_fc.id_tempo as id_tempo_fechamento,\n        dcat.id_categoria,\n        dcan.id_canal,\n        dpri.id_prioridade,\n        dsta.id_status,\n        int.tempo_espera_minutos,\n        int.tempo_resolucao_horas,\n        int.csat_score as pontuacao_csat,\n        int.is_sla_atingido as sla_atingido,\n        int.is_first_contact as resolvido_primeiro_contato\n    from `service-desk-analytics-472019`.`raw_intermediate`.`int_chamados` int\n    left join `service-desk-analytics-472019`.`raw_marts`.`dim_tempo` t_ab\n        on int.dt_abertura = t_ab.data\n    left join `service-desk-analytics-472019`.`raw_marts`.`dim_tempo` t_fc\n        on int.dt_fechamento = t_fc.data\n    left join `service-desk-analytics-472019`.`raw_marts`.`dim_categoria` dcat\n        on int.categoria = dcat.categoria\n    left join `service-desk-analytics-472019`.`raw_marts`.`dim_canal` dcan\n        on int.canal = dcan.canal\n    left join `service-desk-analytics-472019`.`raw_marts`.`dim_prioridade` dpri\n        on int.prioridade = dpri.prioridade\n    left join `service-desk-analytics-472019`.`raw_marts`.`dim_status` dsta\n        on int.status = dsta.status\n)\n\nselect * from base", "relation_name": "`service-desk-analytics-472019`.`raw_marts`.`fato_chamados`"}], "elapsed_time": 13.635971784591675, "args": {"log_format_file": "debug", "populate_cache": true, "write_json": true, "empty": false, "exclude": [], "log_level_file": "debug", "favor_state": false, "log_file_max_bytes": 10485760, "require_explicit_package_overrides_for_builtin_materializations": true, "warn_error_options": {"include": [], "exclude": []}, "defer": false, "log_format": "default", "log_level": "info", "quiet": false, "send_anonymous_usage_stats": true, "version_check": true, "select": [], "target": "prod", "require_resource_names_without_spaces": false, "use_colors_file": true, "macro_debugging": false, "source_freshness_run_project_hooks": false, "vars": {}, "profiles_dir": "/usr/app/dbt", "print": true, "log_path": "/usr/app/dbt/logs", "strict_mode": false, "partial_parse_file_diff": true, "indirect_selection": "eager", "introspect": true, "printer_width": 80, "invocation_command": "dbt run --target prod", "project_dir": "/usr/app/dbt", "partial_parse": true, "cache_selected_only": false, "use_colors": true, "which": "run", "static_parser": true, "enable_legacy_logger": false, "show_resource_report": false}}